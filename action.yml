name: 'process-postman-test-results'

description: |
  Action that parses a json results file  generated by the newman json reporter and creates a status check or pr comment with the results.
  Tests are not run as part of this action.
  The results can be seen on the workflow run or PR.

inputs:
  github-token:
    description: 'Token used to interact with the repository.  Generally secrets.GITHUB_TOKEN.'
    required: true
  status-name:
    description: 'The status check name in action.'
    required: true
    default: Test Results
  ignore-test-failures:
    description: 'Set status to neutral when there are test failures.'
    required: false
    default: 'false'
  create-status-check:
    description: 'Create or not a status check with results.'
    required: true
    default: 'true'
  create-pr-comment:
    description: 'Create or not a PR comment with test results.'
    required: true
    default: 'true'
  update-comment-if-one-exists:
    description: 'When `create-pr-comment` is true, this flag determines whether a new comment is created or if the action updates an existing comment if one is found which is the default behavior.'
    required: true
    default: 'true'
  message:
    description: 'User message to include in status report'
    required: false
    default: ' - '
  total-tests:
    description: 'Total running tests'
    required: true
  failed-tests:
    description: 'failed tests'
    required: true

outputs:
  test-outcome:
    description: 'Test outcome based on presence of failing tests: Failed|Passed.  If exceptions are thrown or if it exits early because of argument errors, this is set to Failed.'

runs:
  using: 'node12'
  main: 'dist/index.js'
